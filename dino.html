<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dinosaurio Prácticamente</title>
<style>
body {
  margin:0;
  background: #87ceeb;
  overflow: hidden;
  font-family: Arial, sans-serif;
}
#gameCanvas {
  display: block;
  margin: auto;
  background: #87ceeb;
}
#controls {
  position: fixed;
  bottom: 10px;
  width: 100%;
  text-align: center;
}
button {
  font-size: 1.5em;
  margin: 0 10px;
  padding: 10px 20px;
}
</style>
</head>
<body>

<canvas id="gameCanvas" width="800" height="400"></canvas>
<div id="controls">
  <button id="jumpBtn">⬆️ Saltar</button>
  <button id="duckBtn">⬇️ Agacharse</button>
</div>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

const GRAVITY = 0.6;
const JUMP_FORCE = -12;
const FLOOR_Y = canvas.height - 80;

let score = 0;

// Dinosaurio
const dinoImg = new Image();
dinoImg.src = "dino.png";

let dino = {
  x: 50,
  y: FLOOR_Y,
  width: 60,
  height: 60,
  vy: 0,
  isJumping: false,
  isDucking: false
};

// Meteoritos
const meteorImg = new Image();
meteorImg.src = "meteor.png";

let meteors = [];

// Cactus
const cactusImg = new Image();
cactusImg.src = "captus.png";

let cactuses = [];

// Controles teclado
const keys = {};
document.addEventListener("keydown", e => {
  keys[e.code] = true;
});
document.addEventListener("keyup", e => {
  keys[e.code] = false;
});

// Controles botones
document.getElementById("jumpBtn").addEventListener("click", ()=> jump());
document.getElementById("duckBtn").addEventListener("mousedown", ()=>duck(true));
document.getElementById("duckBtn").addEventListener("mouseup", ()=>duck(false));

function jump() {
  if(!dino.isJumping){
    dino.vy = JUMP_FORCE;
    dino.isJumping = true;
  }
}

function duck(state) {
  dino.isDucking = state;
  dino.height = state ? 30 : 60;
}

// Colisiones
function checkCollision(rect1, rect2){
  return rect1.x < rect2.x + rect2.width &&
         rect1.x + rect1.width > rect2.x &&
         rect1.y < rect2.y + rect2.height &&
         rect1.y + rect1.height > rect2.y;
}

// Spawn de obstáculos cada intervalo
setInterval(()=>{
  cactuses.push({x:canvas.width, y:FLOOR_Y, width:40, height:60});
}, 1500);

setInterval(()=>{
  const height = Math.random() * 150 + 50;
  meteors.push({x:canvas.width, y:height, width:40, height:40, speed:6});
}, 2000);

// Reinicia juego
function resetGame(){
  score = 0;
  dino.y = FLOOR_Y;
  dino.vy = 0;
  dino.isJumping = false;
  dino.isDucking = false;
  cactuses = [];
  meteors = [];
}

// Actualiza el juego
function update(){
  // Dinosaurio
  dino.vy += GRAVITY;
  dino.y += dino.vy;
  if(dino.y > FLOOR_Y){
    dino.y = FLOOR_Y;
    dino.vy = 0;
    dino.isJumping = false;
  }

  if(keys["Space"]) jump();
  if(keys["ArrowDown"]) duck(true); else duck(false);

  // Obstáculos
  cactuses.forEach((c,i)=>{
    c.x -= 6;
    if(c.x + c.width < 0) cactuses.splice(i,1);
    if(checkCollision(dino,c)) resetGame();
  });

  meteors.forEach((m,i)=>{
    m.x -= m.speed;
    if(m.x + m.width < 0) meteors.splice(i,1);
    if(checkCollision(dino,m)) resetGame();
  });

  score += 1;
}

// Dibuja todo
function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // Piso
  ctx.fillStyle = "#8B4513";
  ctx.fillRect(0,FLOOR_Y+60,canvas.width,20);

  // Nubes
  ctx.fillStyle = "#fff";
  ctx.beginPath();
  ctx.arc(100,50,20,0,Math.PI*2);
  ctx.arc(130,50,30,0,Math.PI*2);
  ctx.arc(160,50,20,0,Math.PI*2);
  ctx.fill();

  // Dinosaurio
  ctx.drawImage(dinoImg, dino.x, dino.y, dino.width, dino.height);

  // Cactus
  cactuses.forEach(c=>{
    ctx.drawImage(cactusImg, c.x, c.y, c.width, c.height);
  });

  // Meteoritos
  meteors.forEach(m=>{
    ctx.drawImage(meteorImg, m.x, m.y, m.width, m.height);
  });

  // Puntaje
  ctx.fillStyle = "#fff";
  ctx.font = "20px Arial";
  ctx.fillText("Score: "+score, canvas.width-120,30);
}

// Loop principal
function gameLoop(){
  update();
  draw();
  requestAnimationFrame(gameLoop);
}

dinoImg.onload = ()=> requestAnimationFrame(gameLoop);
</script>
</body>
</html>
